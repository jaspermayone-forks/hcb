<% title "Card grants for #{@event.name}" %>
<% page_md %>
<%= render "events/nav", selected: :card_grants %>
<%= render "card_grants/create_modal" %>

<h1 class="flex heading items-center">
  <span class="flex-grow flex items-center flex-1">
    Card grants
    <%= badge_for @event.card_grants.active.count, class: "bg-muted" %>
  </span>

  <% if organizer_signed_in?(as: :member) %>
    <%= link_to new_event_card_grant_path(@event), class: "btn bg-success", data: { behavior: "modal_trigger", modal: "create_card_grant" }, disabled: !policy(@event).create_transfer? do %>
      <%= inline_icon "card-add" %>
      Send a grant
    <% end %>
  <% end %>
</h1>

<%= turbo_frame_tag :card_grant_card_overview, src: event_card_grant_card_overview_path(@event), loading: :eager do %>
  <div class="table-container mb2">
    <table>
      <thead>
        <tr>
          <th>Status</th>
          <th>Date</th>
          <th>To</th>
          <th>For</th>
          <th>Amount</th>
          <th class="text-right">Balance</th>
          <th></th>
        </tr>
      </thead>
    </table>
  </div>
  <%= blankslate "Loading..." %>
<% end %>

<%= turbo_frame_tag :card_grant_transaction_overview, src: event_card_grant_transaction_overview_path(@event), loading: :eager do %>
  <h2 class="heading mt4 pb1">Card grant transactions</h2>
  <%= blankslate "Loading..." %>
<% end %>
